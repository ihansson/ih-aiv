{"version":3,"sources":["webpack://aiv/webpack/bootstrap","webpack://aiv/./src/aiv.js"],"names":["enumerable","get","getter","value","key","bind","module","Object","prototype","hasOwnProperty","call","object","property","nodes","last_call","opts","configure","_opts","opt","add","ctx","concat","Array","slice","querySelectorAll","remove","node","aiv","timeout","window","clearTimeout","filter","_node","addEventListener","update","setTimeout","event","document","createEvent","initEvent","pageXOffset","dispatchEvent","load","_nodes","i","load_node","options","triggered","cls","get_attr","out_cls","children","repeat","start_visible","delay","offset","console","log","to_change","in_cls","push","index","target_node","className","now","Date","throttle","visible","y","parseInt","pageYOffset","top","bottom","innerHeight","visible_area","toggle","in_view","offsetTop","offsetHeight","is_in_view","aiv_status","join","attr","def","number","att","attributes","nodeValue","exports","add_nodes","selector","unbind","removeEventListener","init","context","win","body"],"mappings":"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","file":"dist/aiv.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","let nodes = [],\r\n\tlast_call = false,\r\n\topts = {};\r\n\r\n// Update options\r\nfunction configure(_opts){\r\n\tfor(opt in _opts){\r\n\t\topts[opt] = _opts[opt]\r\n\t}\r\n}\r\n\r\n// Add items to context\r\nfunction add(ctx){\r\n\tnodes = nodes.concat(Array.prototype.slice.call(ctx.querySelectorAll('[aiv]')))\r\n}\r\n\r\n// Remove node from list to update\r\nfunction remove(node){\r\n\tif(node.aiv.timeout) window.clearTimeout(node.aiv.timeout)\r\n\tnodes = nodes.filter(_node => _node !== node)\r\n}\r\n\r\n// Bind scroll and resize events to update toggles\r\nfunction bind(ctx){\r\n\tctx.addEventListener('scroll', update)\r\n\tctx.addEventListener('resize', update)\r\n\tctx.setTimeout(function(){\r\n\t\tlet event = document.createEvent(\"Event\");\r\n\t\tevent.initEvent(\"scroll\", false, true); \r\n\t\tif(ctx.pageXOffset == 0) ctx.dispatchEvent(event);\r\n\t}, 60)\r\n}\r\n\r\n// Unbind events\r\nfunction unbind(ctx){\r\n\tctx.removeEventListener('scroll', update)\r\n\tctx.removeEventListener('resize', update)\r\n}\r\n\r\n// Setup before first update\r\nfunction load(){\r\n\tlet _nodes = nodes;\r\n\tfor(i in _nodes) load_node(_nodes[i])\r\n}\r\n\r\n// Sets up initial classes on nodes\r\nfunction load_node(node, options){\r\n\r\n\tnode.aiv = {\r\n\t\ttriggered: false,\r\n\t\tcls : get_attr(node, 'cls', false),\r\n\t\tout_cls : get_attr(node, 'out_cls', false),\r\n\t\tchildren : get_attr(node, 'children', false),\r\n\t\trepeat : get_attr(node, 'repeat', false, false, true),\r\n\t\tstart_visible : get_attr(node, 'start_visible', false, false, true),\r\n\t\tdelay : get_attr(node, 'delay', 0, true),\r\n\t\toffset : get_attr(node, 'offset', 0, true),\r\n\t}\r\n\r\n\tif(options){\r\n\t\tfor(opt in options){\r\n\t\t\tnode.aiv[opt] = options[opt]\r\n\t\t}\r\n\t}\r\n\r\n\tif(node.aiv.children) node.aiv.children = Array.prototype.slice.call(node.querySelectorAll(node.aiv.children));\r\n\r\n\tconsole.log(node, node.aiv)\r\n\r\n\tconst to_change = node.aiv.children ? node.aiv.children : [node]\r\n\r\n\tlet in_cls = [opts.in_cls];\r\n\tif(node.aiv.cls) in_cls.push(node.aiv.cls)\r\n\tlet out_cls = [opts.out_cls];\r\n\tif(node.aiv.out_cls) out_cls.push(node.aiv.out_cls)\r\n\r\n\tfor(index in to_change){\r\n\r\n\t\tlet target_node = to_change[index];\r\n\t\tif(!target_node.aiv) target_node.aiv = {}\r\n\r\n\t\t// Store active and inactive classes. Append the current className\r\n\t\ttarget_node.aiv.in_cls = in_cls.slice();\r\n\t\ttarget_node.aiv.out_cls = out_cls.slice();\r\n\t\ttarget_node.aiv.in_cls.push(target_node.className)\r\n\t\ttarget_node.aiv.out_cls.push(target_node.className)\r\n\r\n\t\t// Don't set initial classes on start_visible nodes\r\n\t\tif(!node.aiv.start_visible){\r\n\t\t\tclassName(target_node, target_node.aiv.out_cls)\r\n\t\t}\r\n\r\n\t}\r\n}\r\n\r\n// Update all nodes\r\nfunction update(){\r\n\tconst now = Date.now();\r\n\tif(last_call && now - last_call < opts.throttle) return;\r\n\tlast_call = now;\r\n\tconst visible = visible_area()\r\n\tlet _nodes = nodes;\r\n\tfor(i in _nodes) toggle(_nodes[i], visible)\r\n}\r\n\r\n// Toggle statuses on a single node\r\nfunction toggle(node, visible){\r\n\r\n\tconst in_view = is_in_view(node, visible);\t\r\n\tconst to_change = node.aiv.children ? node.aiv.children : [node]\r\n\r\n\tfor(index in to_change){\r\n\t\t// Set classes if in\r\n\t\tlet target_node = to_change[index];\r\n\t\tif(in_view && target_node.aiv_status !== 'in'){\r\n\t\t\ttarget_node.aiv_status = 'in';\r\n\t\t\tnode.aiv.triggered = true;\r\n\t\t\tif(node.aiv.delay){\r\n\t\t\t\ttarget_node.aiv.timeout = window.setTimeout(function(){\r\n\t\t\t\t\tclassName(target_node, target_node.aiv.in_cls)\r\n\t\t\t\t}, node.aiv.delay * (node.aiv.children ? index : index + 1))\r\n\t\t\t} else {\r\n\t\t\t\tclassName(target_node, target_node.aiv.in_cls)\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Set classes if out\r\n\t\tif(!in_view && target_node.aiv_status !== 'out'){\r\n\t\t\t// Remove node if it should not repeat\r\n\t\t\tif(target_node.aiv.timeout){\r\n\t\t\t\twindow.clearTimeout(target_node.aiv.timeout)\r\n\t\t\t\ttarget_node.aiv.timeout = false\r\n\t\t\t}\r\n\t\t\tif(node.aiv.triggered && !node.aiv.repeat){\r\n\t\t\t\tremove(node)\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\ttarget_node.aiv_status = 'out';\r\n\t\t\tclassName(target_node, target_node.aiv.out_cls)\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\n// Changes classes to stored _className\r\nfunction className(node, cls){\r\n\tnode.className = cls.join(' ');\r\n}\r\n\r\n// Get attribute values with defaults\r\nfunction get_attr(node, attr, def, number, toggle){\r\n\tconst att = node.attributes['aiv-'+attr];\r\n\tif(!att) return def;\r\n\tif(toggle) return true;\r\n\tif(number) return parseInt(att.nodeValue);\r\n\treturn att.nodeValue;\r\n}\r\n\r\n//\r\nfunction is_in_view(node, visible){\r\n\treturn (node.offsetTop + node.aiv.offset) <= visible.bottom && (node.offsetTop + node.offsetHeight + node.aiv.offset) >= visible.top;\r\n}\r\n\r\n// Get visible area in window\r\nfunction visible_area(){\r\n\tlet y = parseInt(window.pageYOffset);\r\n\treturn {top: y, bottom: y + parseInt(window.innerHeight)}\r\n}\r\n\r\n// JS API\r\nfunction add_nodes(selector, options){\r\n\tlet _nodes = Array.prototype.slice.call(document.querySelectorAll(selector));\r\n\tfor(i in _nodes) load_node(_nodes[i], options)\r\n\tnodes = nodes.concat(_nodes)\r\n}\r\n\r\n// Set default options\r\nfunction init(options, context, win){\r\n\tconfigure(options || {\r\n\t\tin_cls: 'in-view',\r\n\t\tout_cls: 'out-of-view',\r\n\t\tthrottle: 50\r\n\t})\r\n\tadd(context || document.body);\r\n\tload();\r\n\tbind(win || window);\r\n}\r\n\r\nmodule.exports = {\r\n\tconfigure: configure,\r\n\tload: load,\r\n\tadd: add,\r\n\tadd_nodes: add_nodes,\r\n\tremove: remove,\r\n\tbind: bind,\r\n\tunbind: unbind,\r\n\tinit: init\r\n};"],"sourceRoot":""}